---
###############################################################
#                   Authelia configuration                    #
###############################################################

# Server Configuration
server:
  host: 0.0.0.0
  port: 9091

# Logging
log:
  level: info

# Theme
theme: light

# JWT Secret (generate with: openssl rand -base64 32)
jwt_secret: H9n8ToJop14KpMaf58kcv1f2CwW3YGDAihdftxqMT4M=

# Default Redirection URL
default_redirection_url: https://innosilicon.com

# TOTP Configuration (disabled for no 2FA)
totp:
  disable: true

# WebAuthn Configuration (disabled for no 2FA)
webauthn:
  disable: true

# Authentication Backend (FreeIPA LDAP)
authentication_backend:
  ldap:
    implementation: custom
    url: ldap://ipa1.inno.lcl:389
    timeout: 5s
    start_tls: false
    tls:
      skip_verify: false
    base_dn: cn=accounts,dc=inno,dc=lcl
    username_attribute: uid
    additional_users_dn: cn=users
    users_filter: (&({username_attribute}={input})(objectClass=person))
    additional_groups_dn: cn=groups
    groups_filter: (&(member={dn})(objectClass=groupOfNames))
    group_name_attribute: cn
    mail_attribute: mail
    display_name_attribute: displayName
    user: uid=ldapauth,cn=sysaccounts,cn=etc,dc=inno,dc=lcl
    password: ZRJokBADxuct

# Access Control Rules
access_control:
  default_policy: deny
  rules:
    # Allow everyone to access auth portal
    - domain: authelia.innosilicon.com
      policy: bypass
    # Protect your applications - require authentication but no 2FA
    - domain: "*.innosilicon.com"
      policy: one_factor

# Session Configuration
session:
  name: authelia_session
  domain: innosilicon.com  # Root domain for SSO
  same_site: lax
  secret: DucYZ6ZH6HkJheU3wQh3JPppyaT2bN8Kc4coJHVkqfI=
  expiration: 1h
  inactivity: 5m
  remember_me_duration: 1M
  redis:
    host: redis
    port: 6379

# Regulation (brute force protection)
regulation:
  max_retries: 5
  find_time: 2m
  ban_time: 5m

# Storage (local file)
storage:
  encryption_key: 1+nZPF3T0o/v4nNcl24B/kR0eydOAt3CmjK5bWaWi4E=
  local:
    path: /config/db.sqlite3

# Notifier (file-based for simplicity)
notifier:
  disable_startup_check: false
  filesystem:
    filename: /config/notification.txt
